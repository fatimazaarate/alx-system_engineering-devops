#!/usr/bin/env bash
# Redirection

# Define the path to your Nginx configuration file
nginx_config="/etc/nginx/sites-available/default"

# Define the path to your custom pages directory
custom_pages_dir="/path/to/your/custom/pages"

# Define the custom 404 HTML content
custom_404_content=$(cat <<EOL
<!DOCTYPE html>
<html>
<head>
    <title>404 Not Found</title>
</head>
<body>
    <h1>Ceci n'est pas une page</h1>
</body>
</html>
EOL
)

# Update Nginx configuration
cat <<EOL > "$nginx_config"
server {
    server_name _;

    location / {
        try_files \$uri \$uri/ @custom_404;
    }

    location @custom_404 {
        internal;
        root $custom_pages_dir;
        rewrite ^ /custom_404.html break;
    }

    location = /custom_404.html {
        internal;
        root $custom_pages_dir;
    }
}
EOL

# Update custom 404 HTML content
echo "$custom_404_content" > "$custom_pages_dir/custom_404.html"

# Test Nginx configuration and reload
sudo nginx -t && sudo service nginx reload
